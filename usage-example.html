<!-- 
    http://localhost/linked-data-proxy/usage-example.html
-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<script src="//ajax.googleapis.com/ajax/libs/jquery/2.2.2/jquery.min.js"></script>
<link rel="stylesheet" href="http://fontawesome.io/assets/font-awesome/css/font-awesome.css">
    <style>
        input[type="text"] {
            width: calc(100% - 5em);
        }
    </style>
<!-- <link rel="icon" href="icon.png" type="image/png"> -->
<title>usage example</title>
</head>

<body>

    <form id="submit">
    <h1>查詢功能</h1>
        <label>
            查詢單字: 
            <button type="button" class="quick_query">金陵</button>
            <button type="button" class="quick_query">臺灣</button>
            <input type="text" name="query" id="query" value="金陵" />
            <!-- <input type="text" name="query" id="query" value="郁離子" /> -->
            <!-- <input type="text" name="query" id="query" value="臺灣" /> -->
            <!-- <input type="text" name="query" id="query" value="王安石" /> -->
        </label>
        <div>
            <label>
                <input type="checkbox" name="module" value="wiki" checked /> 維基百科 (wiki)
            </label>
            <label>
                <input type="checkbox" name="module" value="moedict" checked /> 字典 (moedict)
            </label>
            <label>
                <input type="checkbox" name="module" value="cbdb" checked /> 中國古代人名 (cbdb)
            </label>
            <label>
                <input type="checkbox" name="module" value="tgaz" checked /> 
                地理資料庫 (tgaz)
            </label>
            <label>
                <input type="checkbox" name="module" value="cdict" checked /> 
                英漢字典 (cdict)
            </label>
            <label>
                <input type="checkbox" name="module" value="pixabay" checked /> 
                圖片資料庫 (pixabay)
            </label>
        </div>
        <button type="submit">SUBMIT</button>
        <br />
        <label>
            查詢網址:
            <input type="text" name="url" id="url" onfocus="this.select()" />
        </label>
    </form>

<div id="result"></div>

<hr />

<form id="vote">
    <h1>投票功能</h1>
    <label>
        查詢單字: 
        <input type="text" name="vote_query" id="vote_query" value="金陵" />
    </label>
    
    <br />
    
    <select name="vote_module" id="vote_module">
        <option value="wiki">維基百科 (wiki)</option>
        <option value="moedict">中文字典 (moedict)</option>
        <option value="cbdb">中國古代人名 (cbdb)</option>
        <option value="tgaz">地理資料庫 (tgaz)</option>
        <option value="cdict">英漢字典 (cdict)</option>
        <option value="pixabay">圖片資料庫 (pixabay)</option>
    </select>
    <label>
        評分:
        <input type="number" name="vote_score" id="vote_score" value="1" />
    </label>
    
    <button type="submit">SUBMIT</button>
    
    <br />
    <label>
        查詢網址:
        <input type="text" name="vote_url" id="vote_url" onfocus="this.select()" />
    </label>
    <div id="vote_result"></div>
</form>

<hr/>

<form id="check">
    <h1>批次確認文字</h1>
    
    <label>
        要確認的文字
        
        <!--
        <input type="text" name="query" id="check_query" value="劉備 關羽  劉備 張飛 劉關張" />
        -->
        
        <!--
        <input type="text" name="query" id="check_query" value="國 初 誠意 伯 劉 公 伯 温 嘗 著 郁 離子 五 巻 覆 瓿 集 并 拾遺 二十 巻 犂 眉 公 集 五 巻 寫 情 集 暨 春秋 明 經 各 四 巻 其 孫 廌 集 御書 及 狀 序 諸 作 曰 翊 運 録 皆 鋟 梓 行 世 然 諸 集 渙 而 無 統 板畫 久 而 寖 湮 學者 病 之 巡 浙 御史 戴 君 用 與其 寀 薛 君 謙 楊 君 琅 謀 重 鋟 廼 録 善本 次第 諸 集 而 冠以 翊 運 録 俾 杭 郡守 張 君 僖 成 之 屬 守 陳 序 維 公 以 命 世豪傑 之 才 出 佐 我 高 皇 剪 羣雄 混 六合 讜 言 谹 議 牖 道 天 � � 偉 略 竒 謀 指 授 羣 帥 者 鼎 彞 勒 之 汗青 書 之 四方 尚 能 道 之 方 其 未 遇 也 鬱積 感 憤發 之 文辭 若 四嶽 之 出雲 無窮 若 公輸 之 營 衆 宇 各盡其 制 若 孫武子 之 師 戈 甲 蔽野 而 不 聞 喑 嗚 叱咤 之 聲 若 大海 浩 溔 中 畜 虬 螭 䱎 䲛 ● ● 之 屬 覩 者 眙 ● 而 莫 能 名 然 皆 載 道 之 航 輪 濟世 之 粱 帛 時 已 傳誦 之 及 逹 而 施 之 朝 廟 播 之 華夷 埀 之 百世 之下 焯 乎 不可 朽 也 三代 之 英 卓 矣 漢 以 降 佐 命 元 勲 多 崛起 草莽 甲兵 間 諳 文墨 者 殊 鮮 子房 之 䇿 不見 辭章 元 齡 之 文 僅 辦 符 檄 未 見 樹 開國 之 勲 業 而 兼 傳世 之 文章 如 公 者 公 可謂 千古 之 人 豪 矣 而 世 或 疑 其 仕 元 或 獨 稱 其 觀象 者 是 猶 訾 伊 尹 之 五 就 知 周 公 止於 才藝 而已 不 亦 陋 乎 三 御史 之 重 鋟 兹 集 蓋 高山景行 之 志 也 守 陳 之 序 居 培 塿 而論 嵩 岱 持 土 苴 而 寘 之 夜光 朝 采 之上 可 乎 哉 成化 六年 夏 六月 四明 楊 守 陳 序" />
        -->
        
        <input type="text" name="query" id="check_query" value="三四 三" />
        
        
        <!-- 
        <input type="text" name="query" id="check_query" value="郁離子" />
        -->
    </label>
    <div>
            <label>
                <input type="checkbox" name="check_module" value="wiki" checked /> 
                維基百科 (wiki)
            </label>
            <label>
                <input type="checkbox" name="check_module" value="moedict"  checked  /> 
                字典 (moedict)
            </label>
            <label>
                <input type="checkbox" name="check_module" value="cbdb" checked /> 
                中國古代人名 (cbdb)
            </label>
            <label>
                <input type="checkbox" name="check_module" value="tgaz" checked /> 
                地理資料庫 (tgaz)
            </label>
            <label>
                <input type="checkbox" name="check_module" value="cdict" checked /> 
                英漢字典 (cdict)
            </label>
            <label>
                <input type="checkbox" name="check_module" value="pixabay" checked />
                圖片資料庫 (pixabay)
            </label>
        </div>
    <button type="submit">SUBMIT</button>
    <div id="check_result"></div>
</form>

<hr/>

<h1>Google分析</h1>
<ul>
<li><a href="https://analytics.google.com/analytics/web/#realtime/rt-content/a46464710w135478152p139632692/" target="_blank" rel="noopener noreferrer">即時內容 (對應查詢功能)</a></li>
<li><a href="https://analytics.google.com/analytics/web/#realtime/rt-event/a46464710w135478152p139632692/" target="_blank" rel="noopener noreferrer">即時事件 (對應模組查詢功能)</a></li>
<li><a href="https://analytics.google.com/analytics/web/#my-reports/tXjtgYhURyS5SGFYFGRC0g/a46464710w135478152p139632692/" target="_blank" rel="noopener noreferrer">UUID Query</a></li>
<li><a href="https://analytics.google.com/analytics/web/#my-reports/JguWGLNaSHuea5YOfHW0EA/a46464710w135478152p139632692/" target="_blank" rel="noopener noreferrer">Vote</a></li>
<li><a href="https://analytics.google.com/analytics/web/#my-reports/cziTEwXxT16sF5D-JYeM1Q/a46464710w135478152p139632692/" target="_blank" rel="noopener noreferrer">Module Query</a></li>
</ul>


<script type="text/javascript" src="/utils.js" id="link_data_proxy_utils"></script>
<script type="text/javascript">
$(function () {
    $("#submit").submit(function () {
        var _query = $("#query").val().trim();
        $("#vote_query").val(_query);
        var _modules = [];
        $("input[name='module']:checked").each(function (i, ele) {
            _modules.push(ele.value);
        });
        
        
        var _url = "/" + _modules.join(",") + "/" + encodeURI(_query) + "?callback=?";
        _url = location.href + _url;
        $("#url").val(_url);
        //window.alert(_url);
        //return;
        /*
        var _result = $("#result").empty();
        _result.html("Loading...");
        $.getJSON(_url, function (_data) {
            $("#result").empty();
            for (var _i = 0; _i < _data.length; _i++) {
                var _d = _data[_i];
                var _module = _d.module;
                if (typeof(_d.response) === "string") {
                    var _response = _d.response;
                    _result.append($("<fieldset><legend>" + _module + "</legend>" + _response + "</fieldset>"));
                }
            }
        });
        return false;
        */
        var _result = $("#result").empty();
        LINK_DATA_PROXY.query(_query, _modules, function (_data) {
            $("#result").empty();
            for (var _i = 0; _i < _data.length; _i++) {
                var _d = _data[_i];
                var _module = _d.module;
                if (typeof(_d.response) === "string") {
                    var _response = _d.response;
                    _result.append($("<fieldset><legend>" + _module + "</legend>" + _response + "</fieldset>"));
                }
            }
        });
        return false;
    });
    
    $(".quick_query").click(function () {
        var _query = this.innerHTML;
        $("#query").val(_query);
        $("#submit").submit();
    });
    
    // ---------------------
    
    $("#vote").submit(function () {
        var _module = $("#vote_module").val();
        var _query = $("#vote_query").val();
        $("#query").val(_query);
        
        var _score = $("#vote_score").val().trim();
        _score = parseInt(_score, 10);
        
        var _url = "/" + _module + "/" + encodeURI(_query) + "/" + _score + "?callback=?";
        
        $("#vote_url").val(_url);
        $("#vote_result").html("Loading...");
        /*
        $.getJSON(_url, function (_data) {
            if (_score > 0) {
                _score = "+" + _score;
            }
            else if (_score === 0) {
                _score = "=0";
            }
            else {
                _score = _score + "";
            }
            
            $("#vote_result").html(_module + ": " + _query + " " + _score);
        });
        */
        LINK_DATA_PROXY.vote(_query, _module, _score, function (_data) {
            if (_score > 0) {
                _score = "+" + _score;
            }
            else if (_score === 0) {
                _score = "=0";
            }
            else {
                _score = _score + "";
            }
            
            $("#vote_result").html(_module + ": " + _query + " " + _score);
        });
        
        return false;
    });
    
    // -------------------------
    
    $("#check").submit(function () {
        $("#check_result").html("Loading...");
        
        var _query = $("#check_query").val().trim();
        var _modules = [];
        $("input[name='check_module']:checked").each(function (i, ele) {
            _modules.push(ele.value);
        });
        
        LINK_DATA_PROXY.check(_query, _modules, function (_result) {
            if (_result !== null 
                    && typeof(_result) !== "string" 
                    && _result !== undefined) {
                _result = _result.join(" ");
            }
            $("#check_result").html(_result);
        });
        return false;
    });
});
</script>
    
</body>
</html>
